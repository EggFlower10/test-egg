// app/extend/context.js
// å®šä¹‰ Symbol æ ‡è¯†ï¼Œç”¨äºç¼“å­˜å±æ€§å€¼ï¼ˆé¿å…åŒä¸€æ¬¡è¯·æ±‚é‡å¤è®¡ç®—ï¼‰
const BAR = Symbol('Context#bar');

module.exports = {
    // ğŸ‘‰ æ–¹æ³•æ‰©å±•ï¼šç»™ ctx å¢åŠ  foo æ–¹æ³•
    foo(param) {
        // this å°±æ˜¯å½“å‰è¯·æ±‚çš„ ctx å¯¹è±¡ï¼Œå¯ä»¥è®¿é—® ctx çš„æ‰€æœ‰åŸç”Ÿå±æ€§/æ–¹æ³•
        return `è°ƒç”¨äº† ctx.foo æ–¹æ³•ï¼Œå‚æ•°ï¼š${param} | å½“å‰è¯·æ±‚è·¯å¾„ï¼š${this.path}`;
    },

    // ğŸ‘‰ å±æ€§æ‰©å±•ï¼šç»™ ctx å¢åŠ  bar å±æ€§ï¼ˆå¸¦ç¼“å­˜ï¼ŒåŒä¸€æ¬¡è¯·æ±‚åªè®¡ç®—ä¸€æ¬¡ï¼‰
    get bar() {
        // å…ˆåˆ¤æ–­ç¼“å­˜æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™è®¡ç®—
        if (!this[BAR]) {
            // ç¤ºä¾‹ï¼šä»è¯·æ±‚å¤´ x-bar å–å€¼ï¼Œæ²¡æœ‰åˆ™ç”¨é»˜è®¤å€¼ 'default-bar'
            this[BAR] = this.get('x-bar') || 'default-bar';
        }
        return this[BAR];
    },
};